create type gender as enum ('FEMALE', 'MALE', 'OTHER');

alter type gender owner to postgres;

create type userstatus as enum ('ACTIVE', 'INACTIVE', 'NONE');

alter type userstatus owner to postgres;

create type usertype as enum ('SYSADMIN', 'USER');

alter type usertype owner to postgres;

create table tbl_permission
(
    id          integer generated by default as identity
        primary key,
    created_at  timestamp(6),
    updated_at  timestamp(6),
    category    varchar(255),
    description varchar(255),
    path        varchar(255)
);

alter table tbl_permission
    owner to postgres;

create table tbl_role
(
    id          integer generated by default as identity
        primary key,
    created_at  timestamp(6),
    updated_at  timestamp(6),
    description varchar(255),
    name        varchar(255)
);

alter table tbl_role
    owner to postgres;

create table tbl_group
(
    id          integer generated by default as identity
        primary key,
    role_id     integer
        unique
        constraint fke17sm3r6jxwtd4dsbummwt6y0
            references tbl_role,
    created_at  timestamp(6),
    updated_at  timestamp(6),
    description varchar(255),
    name        varchar(255)
);

alter table tbl_group
    owner to postgres;

create table tbl_role_has_permission
(
    id            integer generated by default as identity
        primary key,
    permission_id integer
        constraint fkimpu2q9vas7utdl3gti0w2ied
            references tbl_permission,
    role_id       integer
        constraint fk7qnieb63nch1w822p22wu7il9
            references tbl_role,
    created_at    timestamp(6),
    updated_at    timestamp(6)
);

alter table tbl_role_has_permission
    owner to postgres;

create table tbl_user
(
    dob        date,
    created_at timestamp(6),
    id         bigint generated by default as identity
        primary key,
    updated_at timestamp(6),
    phone      varchar(15),
    address    varchar(255),
    avatar     varchar(255),
    email      varchar(255),
    name       varchar(255),
    password   varchar(255),
    username   varchar(255) not null
        unique,
    gender     gender,
    status     userstatus,
    type       usertype
);

alter table tbl_user
    owner to postgres;

create table tbl_group_has_user
(
    group_id   integer
        constraint fkk23xt6t0rhoc1s185sekeayf9
            references tbl_group,
    id         integer generated by default as identity
        primary key,
    created_at timestamp(6),
    updated_at timestamp(6),
    user_id    bigint
        constraint fkqpbvdln7wyp9dnjvrx0mrrnk1
            references tbl_user
);

alter table tbl_group_has_user
    owner to postgres;

create table tbl_user_has_role
(
    id         integer generated by default as identity
        primary key,
    role_id    integer
        constraint fknbcb2rhv9gavk1vtounetntw0
            references tbl_role,
    created_at timestamp(6),
    updated_at timestamp(6),
    user_id    bigint
        constraint fklndw06guu8xedftiuosbtbr0a
            references tbl_user
);

alter table tbl_user_has_role
    owner to postgres;

INSERT INTO tbl_role (id, created_at, updated_at, description, name) VALUES (1, null, null, null, 'SYSADMIN');
INSERT INTO tbl_role (id, created_at, updated_at, description, name) VALUES (2, null, null, null, 'PARENT');
INSERT INTO tbl_role (id, created_at, updated_at, description, name) VALUES (3, null, null, null, 'TEACHER');
INSERT INTO tbl_role (id, created_at, updated_at, description, name) VALUES (4, null, null, null, 'BUS_DRIVER');
INSERT INTO tbl_role (id, created_at, updated_at, description, name) VALUES (5, null, null, null, 'ADMIN');
INSERT INTO tbl_role (id, created_at, updated_at, description, name) VALUES (6, null, null, null, 'ASSISTANT_DRIVER');

INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (1, null, null, '/user', null, '/user/list');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (2, null, null, '/user', null, '/user/{userId}');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (3, null, null, '/user', null, '/user/add');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (4, null, null, '/user', null, '/user/upd');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (5, null, null, '/user', null, '/user/change-pwd');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (6, null, null, '/user', null, '/user/confirm-email');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (7, null, null, '/user', null, '/user/del');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (9, null, null, '/user', null, '<null>');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (10, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (11, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (12, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (13, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (14, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (15, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (16, null, null, '/user', null, null);
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (17, null, null, '/email', null, '/user/send-email');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (18, null, null, '/email', null, '/user/send-verification-email');
INSERT INTO tbl_permission (id, created_at, updated_at, category, description, path) VALUES (8, null, null, '/user', null, '/user/change-status');


INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (1, 2, 2, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (2, 4, 2, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (3, 5, 2, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (4, 6, 2, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (5, 17, 2, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (6, 18, 2, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (7, 2, 3, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (8, 4, 3, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (9, 5, 3, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (10, 6, 3, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (11, 17, 3, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (12, 18, 3, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (13, 2, 4, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (14, 4, 4, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (15, 5, 4, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (16, 6, 4, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (17, 17, 4, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (18, 18, 4, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (19, 1, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (20, 2, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (21, 3, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (22, 4, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (23, 5, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (24, 6, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (25, 7, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (26, 8, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (27, 17, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (28, 18, 5, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (29, 2, 6, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (30, 4, 6, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (31, 5, 6, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (32, 6, 6, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (33, 17, 6, null, null);
INSERT INTO tbl_role_has_permission (id, permission_id, role_id, created_at, updated_at) VALUES (34, 18, 6, null, null);


INSERT INTO tbl_user (id, created_at, updated_at, address, avatar, dob, email, name, password, phone, username, gender, status, type) VALUES (2, '2025-02-15 16:11:34.237000', '2025-02-15 16:11:34.237000', null, null, '2000-02-04', 'parent@gmail.com', 'parent', '$2a$10$F6UdD9COpdExAtPap4SD8.J7flrWEBQG68437TUTDoC.6E/uYNMju', 'string', 'parent', null, 'ACTIVE', null);
INSERT INTO tbl_user (id, created_at, updated_at, address, avatar, dob, email, name, password, phone, username, gender, status, type) VALUES (1, '2025-02-15 16:11:19.907000', '2025-02-15 16:11:19.907000', null, null, '2000-02-04', 'sysadmin@gmail.com', 'sysadmin', '$2a$10$A0TsI6LQXRTz4sEMm/e3Xeknm03B2vvpbXIvEStrcySXXoPbqqULe', 'string', 'sysadmin', null, 'ACTIVE', null);
INSERT INTO tbl_user (id, created_at, updated_at, address, avatar, dob, email, name, password, phone, username, gender, status, type) VALUES (3, '2025-02-15 16:11:46.890000', '2025-02-15 16:11:46.890000', null, null, '2000-02-04', 'teacher@gmail.com', 'teacher', '$2a$10$Af7ZpDnFCaN/sPX.qWS5FOJNCzt7y/egLHTPyw939Ufh93jMBaKcq', 'string', 'teacher', null, 'ACTIVE', null);
INSERT INTO tbl_user (id, created_at, updated_at, address, avatar, dob, email, name, password, phone, username, gender, status, type) VALUES (4, '2025-02-15 16:12:04.710000', '2025-02-15 16:12:04.710000', null, null, '2000-02-04', 'busdriver@gmail.com', 'busdriver', '$2a$10$tItfoi1dzxgscgUb4yzQ0.kTFwpzG0DHwMyaQEnMqUVHT5mc6UuNy', 'string', 'busdriver', null, 'ACTIVE', null);
INSERT INTO tbl_user (id, created_at, updated_at, address, avatar, dob, email, name, password, phone, username, gender, status, type) VALUES (6, '2025-02-15 16:12:41.140000', '2025-02-15 16:12:41.140000', null, null, '2000-02-04', 'assistantdriver@gmail.com', 'assistantdriver', '$2a$10$oHOl1svYNE17uXm0DqI9EuVZrpBvSZMY9ncIIxInAMb91X6Oo.MVe', 'string', 'assistantdriver', null, 'ACTIVE', null);
INSERT INTO tbl_user (id, created_at, updated_at, address, avatar, dob, email, name, password, phone, username, gender, status, type) VALUES (5, '2025-02-15 16:12:17.696000', '2025-02-15 16:12:17.696000', null, null, '2000-02-04', 'admin@gmail.com', 'admin', '$2a$10$haY87NZT4E5bBwE75BoyT.kSdLnlRLNxjDHNwm6KErBxpWrbaythu', 'string', 'admin', null, 'ACTIVE', null);

INSERT INTO tbl_user_has_role (id, role_id, created_at, updated_at, user_id) VALUES (1, 1, null, null, 1);
INSERT INTO tbl_user_has_role (id, role_id, created_at, updated_at, user_id) VALUES (2, 2, null, null, 2);
INSERT INTO tbl_user_has_role (id, role_id, created_at, updated_at, user_id) VALUES (3, 3, null, null, 3);
INSERT INTO tbl_user_has_role (id, role_id, created_at, updated_at, user_id) VALUES (4, 4, null, null, 4);
INSERT INTO tbl_user_has_role (id, role_id, created_at, updated_at, user_id) VALUES (5, 5, null, null, 5);
INSERT INTO tbl_user_has_role (id, role_id, created_at, updated_at, user_id) VALUES (6, 6, null, null, 6);
