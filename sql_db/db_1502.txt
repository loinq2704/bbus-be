create type gender as enum ('FEMALE', 'MALE', 'OTHER');

alter type gender owner to postgres;

create type userstatus as enum ('ACTIVE', 'INACTIVE', 'NONE');

alter type userstatus owner to postgres;

create type usertype as enum ('SYSADMIN', 'USER');

alter type usertype owner to postgres;

create table tbl_permission
(
    id          integer generated by default as identity
        primary key,
    created_at  timestamp(6),
    updated_at  timestamp(6),
    category    varchar(255),
    description varchar(255),
    path        varchar(255)
);

alter table tbl_permission
    owner to postgres;

create table tbl_role
(
    id          integer generated by default as identity
        primary key,
    created_at  timestamp(6),
    updated_at  timestamp(6),
    description varchar(255),
    name        varchar(255)
);

alter table tbl_role
    owner to postgres;

create table tbl_group
(
    id          integer generated by default as identity
        primary key,
    role_id     integer
        unique
        constraint fke17sm3r6jxwtd4dsbummwt6y0
            references tbl_role,
    created_at  timestamp(6),
    updated_at  timestamp(6),
    description varchar(255),
    name        varchar(255)
);

alter table tbl_group
    owner to postgres;

create table tbl_role_has_permission
(
    id            integer generated by default as identity
        primary key,
    permission_id integer
        constraint fkimpu2q9vas7utdl3gti0w2ied
            references tbl_permission,
    role_id       integer
        constraint fk7qnieb63nch1w822p22wu7il9
            references tbl_role,
    created_at    timestamp(6),
    updated_at    timestamp(6)
);

alter table tbl_role_has_permission
    owner to postgres;

create table tbl_user
(
    dob        date,
    created_at timestamp(6),
    id         bigint generated by default as identity
        primary key,
    updated_at timestamp(6),
    phone      varchar(15),
    address    varchar(255),
    avatar     varchar(255),
    email      varchar(255),
    name       varchar(255),
    password   varchar(255),
    username   varchar(255) not null
        unique,
    gender     gender,
    status     userstatus,
    type       usertype
);

alter table tbl_user
    owner to postgres;

create table tbl_group_has_user
(
    group_id   integer
        constraint fkk23xt6t0rhoc1s185sekeayf9
            references tbl_group,
    id         integer generated by default as identity
        primary key,
    created_at timestamp(6),
    updated_at timestamp(6),
    user_id    bigint
        constraint fkqpbvdln7wyp9dnjvrx0mrrnk1
            references tbl_user
);

alter table tbl_group_has_user
    owner to postgres;

create table tbl_user_has_role
(
    id         integer generated by default as identity
        primary key,
    role_id    integer
        constraint fknbcb2rhv9gavk1vtounetntw0
            references tbl_role,
    created_at timestamp(6),
    updated_at timestamp(6),
    user_id    bigint
        constraint fklndw06guu8xedftiuosbtbr0a
            references tbl_user
);

alter table tbl_user_has_role
    owner to postgres;

